# FX Insight Bot フロントエンド画面仕様書

**作成日**: 2026-01-17
**フェーズ**: Phase 5 - フロントエンド構築
**ステータス**: 設計中

---

## 1. 概要

### 1.1 目的
FX自動売買システムの状況を可視化する**表示専用**Webダッシュボードを構築する。
個人利用限定のため、シンプルで保守しやすい構成を優先する。

**注意**: 手動での注文・決済・設定変更はGMOコインアプリから行う。本ダッシュボードは閲覧専用。

### 1.2 技術スタック

| カテゴリ | 技術 | 理由 |
|---------|------|------|
| フレームワーク | React 18 + TypeScript | 型安全性、エコシステム |
| ビルドツール | Vite | 高速ビルド、シンプル設定 |
| UIライブラリ | Tailwind CSS + shadcn/ui | 軽量、カスタマイズ性 |
| グラフ | Recharts | React親和性、軽量 |
| 状態管理 | React Query (TanStack Query) | APIキャッシュ、自動リフレッシュ |
| ルーティング | React Router v6 | 標準的 |
| 認証 | Firebase Authentication | GCP統合、個人利用に最適 |
| ホスティング | Firebase Hosting | 無料枠、簡単デプロイ |

### 1.3 対応ブラウザ
- Chrome（最新版）
- Safari（最新版）
- Firefox（最新版）

### 1.4 レスポンシブ対応
- デスクトップ優先（1280px以上）
- タブレット対応（768px以上）
- モバイル対応（必要に応じて）

---

## 2. 画面構成

### 2.1 画面一覧

| No | 画面名 | URL | 認証 | 説明 |
|----|--------|-----|------|------|
| 1 | ログイン | `/login` | 不要 | Firebase Authentication |
| 2 | ダッシュボード | `/` | 必要 | メイン画面 |
| 3 | ポジション | `/positions` | 必要 | ポジション詳細 |
| 4 | 注文履歴 | `/orders` | 必要 | 注文・取引履歴 |
| 5 | ニュース | `/news` | 必要 | ニュース分析一覧 |
| 6 | シグナル | `/signals` | 必要 | トレードシグナル履歴 |
| 7 | 設定 | `/settings` | 必要 | システム設定 |

### 2.2 画面遷移図

```
[ログイン] ─────→ [ダッシュボード]
                       │
     ┌─────────────────┼─────────────────┐
     │                 │                 │
     ▼                 ▼                 ▼
[ポジション]      [ニュース]        [シグナル]
     │                 │                 │
     └─────────────────┼─────────────────┘
                       │
                       ▼
                   [設定]
```

---

## 3. 画面詳細

### 3.1 ログイン画面 (`/login`)

#### 3.1.1 レイアウト

```
┌────────────────────────────────────────┐
│                                        │
│         FX Insight Bot                 │
│                                        │
│    ┌──────────────────────────┐        │
│    │    Googleでログイン      │        │
│    └──────────────────────────┘        │
│                                        │
│         個人利用限定                   │
│                                        │
└────────────────────────────────────────┘
```

#### 3.1.2 機能
- Googleアカウントでログイン（Firebase Authentication）
- 認証済みの場合はダッシュボードにリダイレクト

---

### 3.2 ダッシュボード (`/`)

#### 3.2.1 レイアウト

```
┌────────────────────────────────────────────────────────────┐
│ [Logo] FX Insight Bot          [環境: dev] [ログアウト]    │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐          │
│  │ 口座残高    │ │ 評価損益    │ │ 証拠金維持率│          │
│  │ ¥7,000     │ │ ¥0         │ │ ---        │          │
│  └─────────────┘ └─────────────┘ └─────────────┘          │
│                                                            │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐          │
│  │ 本日損益    │ │ 月間損益    │ │ 勝率        │          │
│  │ ¥0         │ │ ¥0         │ │ ---%       │          │
│  └─────────────┘ └─────────────┘ └─────────────┘          │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ 損益推移グラフ（日次）                               │ │
│  │                                                      │ │
│  │  [エリアチャート: 累計損益の推移]                    │ │
│  │                                                      │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌────────────────────────┐ ┌────────────────────────────┐│
│  │ 現在のポジション       │ │ 最新シグナル               ││
│  │                        │ │                            ││
│  │ (ポジションがありません)│ │ USD_JPY: HOLD (50%)       ││
│  │                        │ │ 理由: 信頼度不足           ││
│  │                        │ │                            ││
│  └────────────────────────┘ └────────────────────────────┘│
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ 最新ニュース                                        │ │
│  │                                                      │ │
│  │ • [USD/JPY] 日銀金融政策決定会合...    Positive +1  │ │
│  │ • [EUR/JPY] ECB利下げ観測...           Negative -1  │ │
│  │ • [USD/JPY] 米雇用統計発表...          Neutral  0   │ │
│  │                                                      │ │
│  │                           [もっと見る →]             │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ リスク状況                                           │ │
│  │                                                      │ │
│  │ 日次損失: ¥0 / ¥50,000    [████████████░░░░] 0%    │ │
│  │ 取引回数: 0 / 10          [░░░░░░░░░░░░░░░░] 0%    │ │
│  │ リスクレベル: LOW                                    │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

#### 3.2.2 コンポーネント

| コンポーネント | データソース | 更新頻度 |
|---------------|-------------|---------|
| 口座サマリーカード | `GET /api/v1/trade/account` | 30秒 |
| 損益推移グラフ | Firestore `trades` | 5分 |
| ポジション一覧 | `GET /api/v1/trade/positions` | 30秒 |
| 最新シグナル | `GET /api/v1/trade/execute` (DRY-RUN) | 5分 |
| ニュース一覧 | Firestore `news` | 5分 |
| リスク状況 | `GET /api/v1/trade/risk/summary` | 1分 |

#### 3.2.3 インタラクション
- 各カードクリックで詳細画面へ遷移
- グラフ: ホバーで詳細表示
- 自動リフレッシュ（設定可能）

---

### 3.3 ポジション画面 (`/positions`)

#### 3.3.1 レイアウト

```
┌────────────────────────────────────────────────────────────┐
│ ← ダッシュボード   ポジション一覧                          │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ 現在のポジション                              [更新] │ │
│  ├──────────────────────────────────────────────────────┤ │
│  │ 通貨ペア │ 方向 │ 数量 │ 約定価格 │ 現在価格│ 損益   │ │
│  ├──────────────────────────────────────────────────────┤ │
│  │ (ポジションがありません)                              │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ 有効注文                                      [更新] │ │
│  ├──────────────────────────────────────────────────────┤ │
│  │ 注文ID │ 通貨ペア│ 方向│ 数量│ 価格  │ 状態         │ │
│  ├──────────────────────────────────────────────────────┤ │
│  │ (有効な注文がありません)                              │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ※ 注文・決済はGMOコインアプリから行ってください          │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

#### 3.3.2 機能
- ポジション一覧表示（閲覧のみ）
- 有効注文一覧表示（閲覧のみ）
- 手動更新ボタン

---

### 3.4 ニュース画面 (`/news`)

#### 3.4.1 レイアウト

```
┌────────────────────────────────────────────────────────────┐
│ ← ダッシュボード   ニュース分析                            │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  フィルター: [全て ▼] [今日 ▼] [検索...]        [更新]   │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ 2026-01-17 15:30                                     │ │
│  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │ │
│  │ 日銀、金融政策の現状維持を決定                       │ │
│  │                                                      │ │
│  │ センチメント: [Positive +1]                          │ │
│  │ 影響通貨: USD/JPY, EUR/JPY                          │ │
│  │ 時間軸: 短期（1日以内）                              │ │
│  │                                                      │ │
│  │ 要約: 日銀は金融政策決定会合で...                   │ │
│  │                                                      │ │
│  │ 情報源: [日本経済新聞] [ロイター]                   │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ 2026-01-17 09:00                                     │ │
│  │ ...                                                  │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  [1] [2] [3] ... [10] [次へ →]                            │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

#### 3.4.2 機能
- ニュース一覧表示（ページネーション）
- センチメント別フィルター
- 日付範囲フィルター
- キーワード検索

---

### 3.5 シグナル画面 (`/signals`)

#### 3.5.1 レイアウト

```
┌────────────────────────────────────────────────────────────┐
│ ← ダッシュボード   トレードシグナル                        │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ 最新シグナル評価                              [更新] │ │
│  │                                                      │ │
│  │ USD/JPY                                              │ │
│  │ ┌────────────────────────────────────────────────┐  │ │
│  │ │ シグナル: HOLD                                 │  │ │
│  │ │ 信頼度: 50%  [██████████░░░░░░░░░░]            │  │ │
│  │ │ 理由: 信頼度不足 (50% < 70%)                  │  │ │
│  │ │                                                │  │ │
│  │ │ テクニカル分析:                               │  │ │
│  │ │   RSI: 45.2 (中立)                            │  │ │
│  │ │   MACD: 買いシグナル                          │  │ │
│  │ │   MA: 下降トレンド                            │  │ │
│  │ │                                                │  │ │
│  │ │ ニュース分析:                                 │  │ │
│  │ │   センチメント: Neutral (0)                   │  │ │
│  │ │   直近ニュース: 3件                           │  │ │
│  │ └────────────────────────────────────────────────┘  │ │
│  │                                                      │ │
│  │ EUR/JPY                                              │ │
│  │ ┌────────────────────────────────────────────────┐  │ │
│  │ │ シグナル: SELL                                 │  │ │
│  │ │ 信頼度: 72%  [██████████████░░░░░░]            │  │ │
│  │ │ ...                                            │  │ │
│  │ └────────────────────────────────────────────────┘  │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ シグナル履歴                                        │ │
│  │                                                      │ │
│  │ 日時        │ 通貨ペア │ シグナル│ 信頼度│ 結果    │ │
│  │ 2026-01-17 │ USD_JPY │ HOLD   │ 50%  │ -       │ │
│  │ 2026-01-16 │ USD_JPY │ BUY    │ 75%  │ +1,200  │ │
│  │ ...                                                  │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

#### 3.5.2 機能
- 現在のシグナル評価表示（閲覧のみ）
- テクニカル分析詳細表示
- ニュース分析詳細表示
- シグナル履歴一覧

---

### 3.6 設定画面 (`/settings`)

#### 3.6.1 レイアウト

```
┌────────────────────────────────────────────────────────────┐
│ ← ダッシュボード   設定                                    │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ 表示設定                                             │ │
│  │                                                      │ │
│  │ 自動更新間隔: [30] 秒                               │ │
│  │ ダークモード: ON / [OFF]                            │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ システム情報                                         │ │
│  │                                                      │ │
│  │ バックエンドURL: http://localhost:8000              │ │
│  │ 環境: development                                   │ │
│  │ バージョン: 0.1.0                                   │ │
│  │ 最終更新: 2026-01-17 15:30:00                       │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ 現在のトレード設定（参照のみ）                       │ │
│  │                                                      │ │
│  │ 対象通貨ペア: USD_JPY, EUR_JPY                      │ │
│  │ 注文サイズ: 1 万通貨                                │ │
│  │ 最低信頼度: 70%                                     │ │
│  │ ストップロス: 50 pips                               │ │
│  │ テイクプロフィット: 100 pips                        │ │
│  │                                                      │ │
│  │ ※ 設定変更はバックエンドの設定ファイルで行います    │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│                                         [表示設定を保存]   │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

#### 3.6.2 機能
- 表示設定（更新間隔、ダークモード）
- システム情報表示
- 現在のトレード設定表示（参照のみ）

---

## 4. 共通コンポーネント

### 4.1 ヘッダー

```
┌────────────────────────────────────────────────────────────┐
│ [Logo] FX Insight Bot                                      │
│                                                            │
│ [ダッシュボード] [ポジション] [ニュース] [シグナル] [設定] │
│                                                            │
│                        [環境: development] [ログアウト]    │
└────────────────────────────────────────────────────────────┘
```

### 4.2 ステータスバッジ

| ステータス | 色 | 用途 |
|-----------|-----|------|
| BUY | 緑 | 買いシグナル/ポジション |
| SELL | 赤 | 売りシグナル/ポジション |
| HOLD | グレー | 保持シグナル |
| Positive | 緑 | ポジティブセンチメント |
| Negative | 赤 | ネガティブセンチメント |
| Neutral | グレー | 中立センチメント |
| DRY-RUN | 黄色 | DRY-RUNモード |
| LIVE | 赤 | 本番モード |

### 4.3 ローディング/エラー表示

- スケルトンローディング（データ取得中）
- エラーアラート（API エラー時）
- 空状態表示（データなし時）

---

## 5. API連携

### 5.1 バックエンドAPI一覧（フロントエンドで使用するもの）

| エンドポイント | メソッド | 用途 |
|---------------|---------|------|
| `/api/v1/trade/account` | GET | 口座情報取得 |
| `/api/v1/trade/positions` | GET | ポジション一覧 |
| `/api/v1/trade/orders` | GET | 注文一覧 |
| `/api/v1/trade/risk/summary` | GET | リスクサマリー |
| `/health` | GET | ヘルスチェック |

**注意**: 以下のPOST APIはフロントエンドからは使用しない（Cloud Schedulerまたはバックエンドから実行）
- `/api/v1/trade/order` - 注文発注
- `/api/v1/trade/order/cancel` - 注文キャンセル
- `/api/v1/trade/execute` - シグナル実行
- `/api/v1/news/collect` - ニュース収集

### 5.2 Firestore コレクション

| コレクション | 用途 |
|-------------|------|
| `news` | ニュース記事 |
| `signals` | トレードシグナル |
| `trades` | 取引履歴 |
| `settings` | ユーザー設定 |

---

## 6. 認証・認可

### 6.1 認証フロー

```
1. ユーザーがログインページにアクセス
2. 「Googleでログイン」ボタンをクリック
3. Firebase Authentication でGoogle認証
4. 認証成功 → ダッシュボードにリダイレクト
5. 認証失敗 → エラーメッセージ表示
```

### 6.2 認可

- 個人利用のため、ログインユーザーは全機能にアクセス可能
- 将来的にロール管理が必要な場合は拡張

---

## 7. ディレクトリ構成

```
frontend/
├── public/
│   └── favicon.ico
├── src/
│   ├── components/
│   │   ├── common/
│   │   │   ├── Header.tsx
│   │   │   ├── Sidebar.tsx
│   │   │   ├── StatusBadge.tsx
│   │   │   ├── LoadingSpinner.tsx
│   │   │   └── ErrorAlert.tsx
│   │   ├── dashboard/
│   │   │   ├── AccountSummary.tsx
│   │   │   ├── ProfitChart.tsx
│   │   │   ├── PositionList.tsx
│   │   │   ├── SignalCard.tsx
│   │   │   ├── NewsList.tsx
│   │   │   └── RiskStatus.tsx
│   │   ├── positions/
│   │   │   ├── PositionTable.tsx
│   │   │   └── OrderTable.tsx
│   │   ├── news/
│   │   │   ├── NewsCard.tsx
│   │   │   └── NewsFilter.tsx
│   │   └── signals/
│   │       ├── SignalDetail.tsx
│   │       └── SignalHistory.tsx
│   ├── pages/
│   │   ├── LoginPage.tsx
│   │   ├── DashboardPage.tsx
│   │   ├── PositionsPage.tsx
│   │   ├── NewsPage.tsx
│   │   ├── SignalsPage.tsx
│   │   └── SettingsPage.tsx
│   ├── hooks/
│   │   ├── useAuth.ts
│   │   ├── useAccount.ts
│   │   ├── usePositions.ts
│   │   ├── useNews.ts
│   │   └── useSignals.ts
│   ├── services/
│   │   ├── api.ts
│   │   ├── firebase.ts
│   │   └── firestore.ts
│   ├── types/
│   │   ├── account.ts
│   │   ├── position.ts
│   │   ├── order.ts
│   │   ├── news.ts
│   │   └── signal.ts
│   ├── utils/
│   │   ├── format.ts
│   │   └── constants.ts
│   ├── App.tsx
│   ├── main.tsx
│   └── index.css
├── package.json
├── tsconfig.json
├── vite.config.ts
└── tailwind.config.js
```

---

## 8. 実装優先順位

### Phase 5.1: 基盤構築
1. プロジェクトセットアップ（Vite + React + TypeScript）
2. Tailwind CSS + shadcn/ui セットアップ
3. Firebase Authentication 設定
4. ルーティング設定

### Phase 5.2: コア機能
1. ログイン画面
2. ダッシュボード（口座サマリー、リスク状況）
3. ポジション画面（一覧表示）
4. API連携（React Query）

### Phase 5.3: 拡張機能
1. ニュース画面
2. シグナル画面
3. 設定画面
4. グラフ表示（Recharts）

### Phase 5.4: 仕上げ
1. ダークモード対応
2. レスポンシブ対応
3. エラーハンドリング強化
4. パフォーマンス最適化

---

## 9. 未決定事項

### 9.1 検討中

| 項目 | 選択肢 | 備考 |
|------|--------|------|
| 認証プロバイダ | Google / GitHub / Email | 個人利用ならGoogleのみで十分 |
| 通知機能 | ブラウザ通知 / なし | 後から追加可能 |
| モバイル対応 | PWA / レスポンシブのみ | 優先度低 |

### 9.2 Phase 5以降で検討

- BigQuery連携によるパフォーマンスグラフ
- X投稿プレビュー・承認機能
- バックテスト結果表示

---

**作成者**: Claude Opus 4.5
**最終更新**: 2026-01-17
